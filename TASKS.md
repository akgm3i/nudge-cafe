# 実装計画兼タスク管理

このドキュメントは実装計画であり、タスク管理も兼ねている。作業を進める際は該当タスクの進捗を更新していく。
タスクは1つずつ進めること。タスク完了前に、必ずlintとtestが通ることを確認すること。タスク完了後、チェックを入れること。

## 全体進捗

- [x] Phase 0: 設計ドキュメントの拡充
- [x] Phase 1: プロジェクト基盤の構築
- [ ] Phase 2: コア体験フローの実装
- [ ] Phase 3: ゲーム進行と物語の実装
- [ ] Phase 4: 仕上げと永続化
- [ ] Phase 5: 最終章とエンディング

---

## Phase 0: 設計ドキュメントの拡充

- [x] **タスク: 設計ドキュメントのコンセプト変更**
  - 内容: 全ての設計ドキュメントを「体験先行・仮説検証型」の新コンセプトに合わせて更新した。
  - 完了要件:
    - [x] 全てのドキュメントが新コンセプトに準拠している。
  - 進捗: 完了。

---

## Phase 1: プロジェクト基盤の構築

- [x] **タスク: React+TypeScriptプロジェクトの初期セットアップ**
  - 内容: `create-react-app`等を用いてプロジェクトを作成し、Linter/Formatter(ESLint/Prettier)を導入。基本的なディレクトリ構成を整備する。
  - 参照: `docs/dev/overview.md`
  - 完了要件:
    - [x] React+TypeScriptのプロジェクトが作成されている。
    - [x] `src/components`, `src/pages`, `src/hooks`, `src/types` などの基本的なディレクトリが整備されている。
    - [x] `npm run lint`, `npm run format` が利用可能。
  - 進捗: 完了。

- [x] **タスク: GitHub ActionsによるCI/CDパイプラインの構築**
  - 内容: push時に自動でビルド、テスト、デプロイが行われるワークフローを構築する。
  - 参照: `docs/dev/overview.md`, `docs/dev/asset-pipeline.md`
  - 完了要件:
    - [x] push時に`npm run build`が実行され、成功することを確認する。
    - [x] mainブランチへのマージ時にGitHub Pagesへ自動デプロイされる。
  - 進捗: 完了。

- [x] **タスク: メイン画面の基本レイアウト実装**
  - 内容: ヘッダー、メインビュー、フッターの3つの領域を持つ基本的なレイアウトコンポーネントを実装する。
  - 参照: `docs/dev/uiux.md`
  - 完了要件:
    - [x] ヘッダー領域にリソース（所持金、評判）と設定アイコンのプレースホルダーが配置される。
    - [x] フッター領域に「ノート」「メニュー開発」「内装変更」ボタンのプレースホルダーが配置される。
    - [x] メインビュー領域が中央に配置される。
  - 進捗: 完了。

---

## Phase 2: コア体験フローの実装

- [x] **タスク: カフェ店内とキャラクターの表示**
  - 内容: メインビューにカフェの背景と、歩き回るニャッジやホーソーン教授の基本的なアニメーションを実装する。
  - 参照: `docs/dev/uiux.md`, `docs/dev/design.md`
  - 完了要件:
    - [x] カフェの背景画像が表示される。(react-konvaによるプレースホルダーとして実装)
    - [x] ニャッジと教授のキャラクターが画面内に表示され、簡単なアニメーションを行う。(react-konvaによるプレースホルダーとして実装)
  - 進捗: 完了。

- [ ] **タスク: 【サイクル基盤】「体験→応用」サイクルの基本システム実装**
  - 内容: 「体験→仮説記録」と「応用→完成記録」という2段階のフェーズを管理し、一連のゲームサイクルを進行させるための基本的なロジックとUIコンポーネントを実装する。
  - 参照: `docs/dev/system.md`, `docs/dev/uiux.md`
  - 完了要件:
    - [ ] チャプターの進行状況（体験、応用、記録待ちなど）を管理できる。
    - [ ] 各フェーズに応じたUI（NPCとの対話、メニュー開発、ノート記録など）を切り替えて表示できる。
  - 進捗: 未着手。

- [ ] **タスク: 【体験】プレイヤーが理論の対象となるイベント実装**
  - 内容: プレイヤーが行動経済学の理論を「体験」する側のシナリオ（例：行商人との取引）を再生するための会話劇・選択肢UIを実装する。
  - 参照: `docs/dev/uiux.md`
  - 完了要件:
    - [ ] NPCとの会話と、プレイヤーの選択肢ボタンが表示されるモーダルUIが実装されている。
    - [ ] プレイヤーの選択に応じて、結果がフィードバックされる。
  - 進捗: 未着手。

- [ ] **タスク: 【応用】プレイヤーが理論を実践する機能の実装**
  - 内容: プレイヤーが学んだ知識を「応用」するための既存機能（メニュー開発、内装変更）を、ゲームサイクルに正式に組み込む。
  - 参照: `docs/dev/uiux.md`
  - 完了要件:
    - [ ] 「メニュー開発」画面で、発見した法則に基づいたメニューを作成・変更できる。
    - [ ] 「内装変更」画面で、発見した法則に基づいた内装の変更ができる。
  - 進捗: 未着手。

- [ ] **タスク: 【記録】2段階記録式・発見ノートの実装**
  - 内容: 新しい設計に基づき、仮説の「下書き」と結果の「追記」という2段階の記録が可能な「発見ノート」のUIとロジックを実装する。
  - 参照: `docs/dev/system.md` (セクション2), `docs/dev/data-structure.md`
  - 完了要件:
    - [ ] 「体験」フェーズ完了後、ノートに「下書き」を作成できる。
    - [ ] 下書きは、未完成状態であることが視覚的にわかる（例：栞）。
    - [ ] 「応用」フェーズ完了後、下書きに結果を追記し、記録を「完成」させることができる。
    - [ ] 記録した内容は `gameState` に保存される。
  - 進捗: 未着手。

---

## Phase 3: ゲーム進行と物語の実装

- [ ] **タスク: ゲーム状態管理システムの導入**
  - 内容: ゲーム全体の状態（所持金、評判、チャプターID、発見ノートの内容など）を一元管理するシステム（Context APIやZustandなど）を導入する。
  - 参照: `docs/dev/system.md`, `docs/dev/data-structure.md`
  - 完了要件:
    - [ ] ゲームの状態がグローバルに管理されるようになっている。
    - [ ] 各コンポーネントから状態の参照・更新が可能。
  - 進捗: 未着手。

- [ ] **タスク: ストーリー進行エンジンの実装**
  - 内容: `game-scenario.md`で定義されたチャプターやイベントのシナリオデータを読み込み、ゲームの進行度に応じてシナリオを再生する基本的なエンジンを実装する。
  - 参照: `docs/dev/story.md`, `docs/dev/game-scenario.md`
  - 完了要件:
    - [ ] シナリオデータ（登場人物、セリフ、選択肢、進行フラグなど）をJSONなどで定義できる。
    - [ ] 特定の条件（例: 評判が一定値に達する）で次のチャプターが解放される。
  - 進捗: 未着手。

- [ ] **タスク: 【シナリオ】プロローグと序章の実装**
  - 内容: `game-scenario.md`に基づき、プロローグと序章のチュートリアルを実装する。
  - 参照: `docs/dev/game-scenario.md`
  - 完了要件:
    - [ ] プロローグのイベントが再生される。
    - [ ] 序章のチュートリアルがプレイできる。
  - 進捗: 未着手。

- [ ] **タスク: 【シナリオ】第一部 Chapter 1 (おとり効果)の実装**
  - 内容: `game-scenario.md`に基づき、Chapter 1の「体験→応用」サイクルを最後までプレイできるように実装する。
  - 参照: `docs/dev/game-scenario.md`
  - 完了要件:
    - [ ] Chapter 1の全イベントが、Phase2で構築したシステム上で進行する。
  - 進捗: 未着手。

- [ ] **タスク: 【シナリオ】第一部 Chapter 2 (アンカリング効果)の実装**
  - 内容: `game-scenario.md`に基づき、Chapter 2の「体験→応用」サイクルを最後までプレイできるように実装する。
  - 参照: `docs/dev/game-scenario.md`
  - 完了要件:
    - [ ] Chapter 2の全イベントが、Phase2で構築したシステム上で進行する。
  - 進捗: 未着手。

- [ ] **タスク: 【シナリオ】第一部 Chapter 3 (フレーミング効果)の実装**
  - 内容: `game-scenario.md`に基づき、Chapter 3の「体験→応用」サイクルを最後までプレイできるように実装する。
  - 参照: `docs/dev/game-scenario.md`
  - 完了要件:
    - [ ] Chapter 3の全イベントが、Phase2で構築したシステム上で進行する。
  - 進捗: 未着手。

---

## Phase 4: 仕上げと永続化

- [ ] **タスク: ゲームデータの永続化**
  - 内容: ゲームの状態をブラウザの`localStorage`に保存し、次回起動時に読み込む機能を実装する。
  - 参照: `docs/dev/data-structure.md` (セクション3)
  - 完了要件:
    - [ ] ゲームの状態が定期的に、または特定のタイミングでLocalStorageに保存される。
    - [ ] ページをリロードしても前回の状態から再開できる。
    - [ ] 設定メニューにセーブ/リセットボタンを実装する。
  - 進捗: 未着手。

- [ ] **タスク: サウンド機能の実装**
  - 内容: BGMと、ボタンタップや成功/失敗時の効果音を再生する機能を実装する。
  - 参照: `docs/dev/animation-sound.md`
  - 完了要件:
    - [ ] 設定メニューから音量のON/OFF、調整ができる。
    - [ ] 各シーンでBGMが再生される。
    - [ ] 主要なインタラクションに効果音がつく。
  - 進捗: 未着手。

- [ ] **タスク: 【シナリオ】第二部の章を実装**
  - 内容: 第二部のストーリー（現在志向バイアス、サンクコスト効果など）を実装する。各章を個別のタスクとして管理することが望ましい。
  - 参照: `docs/dev/story.md`, `docs/dev/game-scenario.md`
  - 完了要件:
    - [ ] 第二部の各チャプターがプレイ可能になっている。
  - 進捗: 未着手。

---

## Phase 5: 最終章とエンディング

- [ ] **タスク: 最終章（お祭りイベント）の実装**
  - 内容: 最終章の特別イベント「街のお祭り」を実装する。これまでに発見ノートに記録した知識を総動員する集大成的な内容とする。
  - 参照: `docs/dev/story.md`, `docs/dev/game-scenario.md`
  - 完了要件:
    - [ ] お祭りに関連する専用のUIやゲームメカニクスが実装されている。
    - [ ] 複数の発見を組み合わせて課題を解決する流れが体験できる。
  - 進捗: 未着手。

- [ ] **タスク: エピローグとエンディングの実装**
  - 内容: 発見ノートの最後のページをプレイヤーが記し、エンディングの演出を実装する。
  - 参照: `docs/dev/story.md`, `docs/dev/game-scenario.md`
  - 完了要件:
    - [ ] 最終章クリア後にエンディングが再生される。
    - [ ] スタッフロールや「はじめから」を選択できる画面が表示される。
  - 進捗: 未着手。
